
ver 1.4.3         2024/06/01
  * ubuntu 24.04 LTS 対応
    ubuntu 24.04 LTS では、パッケージの ruby-gtk2 がインストール出来な
    くなっている。その結果それに依存した raspirecTV.rb が動作しなくな
    るので、gtk2 -> gtk3 変更対応を行った。(機能は変わらず)
       https://github.com/kaikoma-soft/raspirec/issues/11

    その為 raspirecTV.rb をお使いの方は ruby-gtk3 をインストールする必
    要があります。

ver 1.4.2         2024/03/01
  * 機能追加
    * 起動時にチューナーデバイスの読み書き権限のチェックをするように。
      (エラーメッセージのみで、異常終了にはしない。)

ver 1.4.1         2023/05/01
  * 不具合修正
    * 自動予約の対象になった番組の evid が、過去に録画した番組の evid
      と重複した場合、予約がスッポ抜ける不具合の修正
      ( ver 1.3.8 での修正が不十分だったので追加 )

    * 録画中の番組の evid が、過去に録画した番組の evid と重複した場合、
      終了時間が早くなってしまう不具合の修正

ver 1.4.0         2022/12/09
  * 不具合修正
    * 高負荷により前番組の番組延長検出処理に遅れが起き、その処理が終了
      する前に次番組の自動予約の録画が開始されると、録画中の番組が２重
      録画になってしまう不具合の修正。
  * 機能追加
    * 定数 EpgPatchEnable = :auto で、定数 Recpt1_cmd が recdvb なら
      true、それ以外は false に再設定する機能を追加

ver 1.3.9         2022/11/12
  * 2022/11/01 に BSスカパーが停波した影響で、放送大学とＢＳ釣りビジョ
    ンが正常に受信出来ない件の補正。(使用環境によるので補足説明を参照)
     * EpgPatch/2022-11-12.dat を追加。
     * EpgPatch の下の他の dat を削除
     * その他->コントロールパネル->補足説明 に「Epg データを修正する機能」
       の項目を追加
    EpgPatch機能を有効にするには、config.rb に "EpgPatchEnable = true" を
    設定した上で raspirecの再起動とEPG更新が必要です。
    無効にするには "EpgPatchEnable = false" を設定して下さい。

ver 1.3.8         2022/10/17
  * 不具合修正
    * 自動予約の対象になった番組の evid が、過去に録画した番組の evid
      と重複した場合、予約がスッポ抜ける不具合の修正

ver 1.3.7         2022/10/07
  * 不具合修正
    * 自動予約で予約したものが重複無効なった後、タイトル変更になった場合に、
      追従しなかった不具合を修正。合わせて、タイトル変更により重複無効から
      有効に戻らない不具合を修正。
  * 改良
    * 録画開始後にタイトルが変更になった場合、TSファイル名を変更後のも
      のに rename するように。

ver 1.3.6         2022/09/07
  * 改良
    * Ubuntu 22 対応
      Ubuntu 22 に update すると ruby が 3.0 になり、それに伴い
      psych(YAML) がセキュリティ強化のため非互換になった。
      その差異を吸収する為のラッパーを追加して新旧どちらでも動作するように。
    * デバッグ用として、番組情報の変更時に log を残すように。
       #{LogDir}/epg_diff_曜日.log
       
ver 1.3.5         2022/08/01
  * 不具合修正
    * Ver1.3.2 で作り込んだバグの為、番組情報の更新がされない不具合の修正
    * コントロールパネルの文言を修正
     「EPGの強制取得」→「EPGの取得 (録画中は保留されます。)」
    *「config 情報」中の github page への URL が間違っているのを3箇所修正

ver 1.3.4         2022/07/17
  ・不具合修正
    https://github.com/kaikoma-soft/raspirec/issues/10
    で指摘されたバグを修正
    
ver 1.3.3         2022/01/05
  * 改良
    * 自動予約一覧で、予約件数の表示を 有効／一致件数 に変更。
       (重複で無効化された場合に有効件数 0 で気がつく様に)
    * 番組表で、赤枠(予約済み)をクリックした時に、修正／削除が出来るように。
    * 「自動予約」->「表示」の一覧で、予約の修正／削除が出来るように。

ver 1.3.2         2021/11/03
  * 改良
    * SQLite3::Busy 対策 その２
      * EPG読み込み処理の時間短縮、トランザクションが必要な部分を分離独立
      * タイムアウト時間のパラメータ調整

ver 1.3.1         2021/10/23
  * 不具合修正
    * 番組延長検出時の再スケジュールで、時短対象の番組が移動し,録画時
      間未達になってしまう現象の修正
    * 録画中の番組を中止すると、録画時間未達になるのを修正
    
  * 改良
    * 番組延長検出時において同時終了する番組が多い場合に DBアクセスが
      競合するのを防止する為に EPG更新のDBアクセスを直列化して負荷を平準化

ver 1.3.0         2021/09/23
  * 機能追加
    * 録画中の番組が延長になった場合に、自動で追従する機能を追加
      詳細は https://kaikoma-soft.github.io/src/raspirec-RecExt.html を参照
    * コントロールパネルに、ログファイルの強制ローテートを追加

  * 変更
    * ラズパイ3B+ で、高負荷時に SQLite3::Busy による Deadlock が発生
      するので、トランザクション関係を見直し。
    * 従来は録画中の Disk容量確保はしなかったが、するように。(DiskFull回避優先)
    
  * 注意
    上記機能追加に伴い、録画終了の方法を recpt1/recdvb 任せから、
    raspirec の時計で終了させる方法に変更した。
    その為、従来より After_margin を 2秒程度遅くしなければならない。

ver 1.2.0         2021/07/04
  * 機能追加
    * 「mpvモニタ機能」を独立した GUI にしたツール raspirecTV.rb を追加。
       詳細は https://kaikoma-soft.github.io/src/raspirec-TV.html を参照
     
  * 変更
    * config の定数 MPlayer_cmd を廃止し、Mpv_cmd と Mpv_opt を新設


ver 1.1.1         2021/05/30
  *機能追加
    * EPG取得時の使用チューナー数を制限する 定数 EPG_tuner_limit を
      config.rb に導入


ver 1.1.0         2021/05/27
  ・機能追加
    + PX-MLT8PE のような 3波(地デジ/BS/CS)チューナーへの対応
        (注：実物は所有していないので、ダミー環境でのテストのみ )
       * config.rb に GBC_tuner_num, DeviceList_GBC を追加
       * 予約スケジュール計算ルーチンの全面書き換え。
       * mpv モニタで、3波を選択可能に。
    + DeviceList_* にデバイスの自動検出機能の追加( DevAutoDetection )
      ( 詳細は、コントールパネル->補足説明->デバイスの自動検出 を参照 )
    + DB ファイルのバックアップを自動で残すように。(一週間分)
    
  ・不具合修正
    + https://github.com/kaikoma-soft/raspirec/issues/9 で指摘された
      番組表等のツールチップの不具合を Materialize のツールチップから
      自前のツールチップに変更して対策。
    + earth_pt1 + recdvb の環境で、mpv モニタが動作していなかった件を
      修正

  ・ 改良
    + 自動予約で一致件数が多い場合に、時間が掛かっていたのを改善。
    + EPG 取得時に全部のチューナーを使うように。
      (従来は地デジ、BS/CS で、1本ずつ)
    + 録画開始直前の EPG取得
       * 取得タイミングを録画開始 20分前から 10分前に変更
       * 取得時間を config で指定した値が 60秒以上なら 60秒に制限して取得。
       * config で指定した局では無く録画対象の局から直接取得する様に。


ver 1.0.4         2021/05/01
  ・ 環境により EpgPatch機能が不要になる事が判明したので、 EpgPatch
     機能を無効にするパラメータ EpgPatchEnable を config.rb に追加した。
     (デフォルトは有効)

     具体的な設定は、放送大学ex (BS11_2, 231ch) が 
     BS11_1 で受信できる場合は   EpgPatchEnable = true
     BS11_2 で受信できる場合は   EpgPatchEnable = false
     又は
     px4_drv + recpt1 の場合は   EpgPatchEnable = true
     pt1_drv + recpt1 の場合は   EpgPatchEnable = true
     earth_pt1 + recdvb の場合は EpgPatchEnable = false

ver 1.0.3         2021/04/13
  ・4/13 のトランスポンダの移動で、ＢＳ釣りビジョンに EPG とのズレが生
    じたので、EpgPatch/2021-04-13.dat を追加。
    有効にするには、raspirecの再起動とEPG更新が必要です。

ver 1.0.2         2021/04/04
  ・不具合修正
    *「録画済み一覧」から自動予約を削除した時に、「録画済み一覧」
       の画面に戻らない件を修正

ver 1.0.1         2021/04/02
  ・機能追加
    * top画面に、「過去3日間の録画エラー数」の表示を追加

ver 1.0.0         2021/03/20
  ・機能追加
    * tspacketchk によるパケットの健全性チェックの組み込み
      設定方法は、
      https://kaikoma-soft.github.io/src/raspirec-packetchk.html を参照

  ・機能追加が一段落したのでβ版からリリース版に昇格

ver 0.6.4         2021/02/20
  ・稀に Ubuntu 20 で waitpid()の競合が起き「終了処理未了」になる件の対策

ver 0.6.3         2021/02/09
  ・BS再編の記録を残すように。
  ・改良
    *「その他」->「コントロールパネル」->「チャンネル情報」で、削除ボ
      タンを常に押せるように変更。

ver 0.6.2         2021/01/05
  ・改良
    * ファイル転送の2重実行をしないように排他制御を導入
  ・不具合修正
    * 番組表等でタイトルに " が含まれると表示が崩れる件を修正

ver 0.6.1         2020/11/14
  ・機能追加
    * 自動予約一覧とフィルター一覧で、共通だった表のソートの設定値の保
      存を分離した。

ver 0.6.0         2020/10/16

  ・機能追加
    * 自動予約一覧で、表にジャンルの項を追加
    * 自動予約一覧で、表のソート機能を追加
    * 番組検索の画面に削除ボタンを追加(ただし新規の場合は出さない)
    * 番組検索の画面に検索文字列をコピーするボタンを追加
    * --config オプションの追加
    * 番組表や検索結果から自動予約する時の初期値でジャンルの小項目は
      "全て" に置き換える

  ・不具合修正
    * 番組表->詳細->録画予約 した時のダイアログの時短の文章の文字色が
      灰色になっているのを修正
    * 局ごとの番組表から詳細ダイアログで「視聴」ボタンが押せてしまう件
      を修正

ver 0.5.0         2020/06/17

  ・機能追加
    * mpv を使ったモニタ機能の追加
      設定方法は、https://kaikoma-soft.github.io/raspirec-option.html を参照
    * プルダウンの config と help をコントロールパネル中に移動 and 名称変更

ver 0.4.1         2020/06/01

  ・機能追加
    * EPG取得の禁止時間帯を設定出来るように config.rb の EpgBanTime
      を追加
      ( https://github.com/kaikoma-soft/raspirec/issues/7 を参照)

ver 0.4.0         2020/05/03

  ・機能追加
    * EPGデータにパッチを当てる機能を追加
      2020/03/末の FOXスポーツエンタ停波による影響で、EPGデータと実際
      のslot番号がズレる現象があり、放送大学とＢＳスカパー！が受信出来
      ない問題をこれで解消する。
    * チャンネル毎に更新日時を記録するように。
    * EPGチャンネルデータに変更があった場合に、DB をアップデートするように。
    * コントロールパネル中に「チャンネル情報」を追加
    * チャンネル情報を一覧で表示し、不要になったチャンネルを削除出来る
      ように。

ver 0.3.5         2020/04/16

  ・不具合修正
    * フイルターの検索結果表示で、録画中のものが×と誤表示されてしまう
      件の修正

ver 0.3.4         2020/04/12

  ・不具合修正
    * フイルターの検索結果表示で、過去になった番組も表示してしまう件の
      修正

ver 0.3.3         2020/03/29

  ・「自動予約」ボタンを押して番組検索に遷移した時に、題名および検索文
     字列を番組タイトルから生成する為の文字削除をユーザーがカスタマイ
     ズ出来るように config.rb に項目追加

ver 0.3.2         2020/03/18

  ・不具合修正
    * 自動予約で放送時間に条件を付けていた場合、スケジューラーが時短
      を行わないバグの修正

ver 0.3.1         2020/02/10

  ・番組検索に放送時間の項目を追加
  ・局毎番組表にも「オプション」のボタンを追加。


ver 0.3.0         2020/02/01

  ・番組表に「オプション」のボタンを追加。
    そのダイアログで、番組表の縦軸、横軸等を可変に出来る機能を追加
  ・コード整理：ajax の書き方の統一
  ・不具合修正
    * 予約一覧のダイアログで、一部の文字が薄かったのを修正

ver 0.2.3         2019/12/18

  ・出力するTSファイルのファイル名をカスタマイズ出来るように,
    config.rb に TSnameFormat を追加。
    ドキュメントも追加したので、詳細は doc/TS_file_name.md を参照。

  ・不具合修正
    * 録画中止の後にそれと重なる予約をすると、予約状況表にズレが生じる
      不具合の修正

ver 0.2.2         2019/12/16
  ・不具合修正
    * デバック用の require 'sinatra/reloader' が残っていたのを削除
  ・Readme.md の詳細を github pages に移動

ver 0.2.1         2019/11/07
  ・モバイル版で、メニューのモニタ機能のOn/Off の制御が抜けていたのを修正

ver 0.2.0         2019/11/01
  ・機能追加
    * 番組検索の局名から局番組表へ飛べるように
    * DISK削除で、空のディレクトリも削除するように。
    * html5 video モニタ機能の追加
  ・不具合修正
    * 録画済み一覧で、既に削除済みの自動登録へのリンクをクリックすると
      帰ってこない件を修正

ver 0.1.2         2019/10/01
  ・EPG 取得時 Timeout を伸ばす。

ver 0.1.1         2019/09/27
  ・EPG 取得時の fork に Timeout処理を追加
  ・データ放送等を番組表から除外する機能追加
  ・ディスク容量確保動作を１日一回から 6時間毎に変更
  ・config.rb に StationPage (番組表で１ページ当たりの放送局数)を追加
  ・予約削除する時の確認ダイアログに、対象のタイトルを表示するように
  ・Bug Fix
     * 予約した後に番組名の変更があった場合に追従しなかったのを修正



ver 0.1.0         2019/09/23
  ・β版 公開初版
